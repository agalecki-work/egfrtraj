% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/classify_single_trajectory.R
\name{classify_single_trajectory}
\alias{classify_single_trajectory}
\title{Classify a single eGFR trajectory}
\usage{
classify_single_trajectory(
  df,
  id_col = "id",
  time_col = "time",
  egfr_col = "egfr",
  bic_tie_threshold = 4,
  ci_level = 0.95
)
}
\arguments{
\item{df}{A data frame containing data for \strong{exactly one subject} with columns for
time and eGFR (and optionally others).}

\item{id_col}{Name of the subject ID column (default: \code{"id"}).}

\item{time_col}{Name of the time column (default: \code{"time"}).}

\item{egfr_col}{Name of the eGFR column (default: \code{"egfr"}).}

\item{bic_tie_threshold}{BIC difference threshold for preferring segmented over simpler models
(default: \code{4}).}

\item{ci_level}{Confidence level for prediction intervals (default: \code{0.95}).}
}
\value{
A list object of class \code{"egfr_traj"} with components:
\describe{
\item{id}{Subject identifier (factor or character).}
\item{trajectory}{Tibble with observed data (\code{id}, \code{time}, \code{egfr}) and fitted values /
prediction intervals for all models (\code{lin_fitted}, \code{lin_conf.low}, etc.).}
\item{models}{One-row tibble with list-columns:
\itemize{
\item \code{info}: list with \code{pattern}, \code{nobs}, \code{nmiss}, \code{breakpoint_time}, \code{bp_se}
\item \code{linear}, \code{quadratic}, \code{segmented}: lists with model coefficients, SEs, AIC/BIC
}
}
}
}
\description{
Fits linear, quadratic, and segmented regression models to eGFR data from one subject.
Selects the best model using BIC with a tie-breaker favoring segmented if the difference
is within \code{bic_tie_threshold}. If a segmented model is selected but no reliable breakpoint
is estimated (\code{breakpoint_time} is NA), it is downgraded to linear.
}
\details{
\itemize{
\item The function filters out rows with missing \code{time} or \code{egfr}.
\item If fewer than 5 valid observations remain, returns a special \code{"insufficient_data"} result.
\item Model selection prefers segmented when BIC improvement is small (tie-breaker).
\item Segmented models with unreliable breakpoint (\code{NA}) are downgraded to linear.
}
}
\examples{
library(egfrtraj)

# Select one subject (true pattern: linear)
single_df <- example_egfr_data \%>\% dplyr::filter(id == "1")

# Classify
traj <- classify_single_trajectory(single_df)

# Inspect results
class(traj)
methods(class = "egfr_traj")
summary(traj)
plot(traj)

}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/classify_multiple_trajectories.R
\name{classify_multiple_trajectories}
\alias{classify_multiple_trajectories}
\title{Classify multiple eGFR trajectories}
\usage{
classify_multiple_trajectories(
  data,
  id_col = "id",
  time_col = "time",
  egfr_col = "egfr",
  bic_tie_threshold = 4,
  ci_level = 0.95,
  best_model_only = TRUE,
  estimates_only = FALSE
)
}
\arguments{
\item{data}{A data frame containing longitudinal eGFR data for one or more subjects.}

\item{id_col}{Name of the subject ID column (default: \code{"id"}).}

\item{time_col}{Name of the time column (default: \code{"time"}).}

\item{egfr_col}{Name of the eGFR column (default: \code{"egfr"}).}

\item{bic_tie_threshold}{BIC difference threshold for preferring segmented (default: \code{4}).}

\item{ci_level}{Confidence level for prediction intervals (default: \code{0.95}).}

\item{best_model_only}{Logical. If \code{TRUE} (default), keep only the selected model's
fitted values and coefficients.}

\item{estimates_only}{Logical. If \code{TRUE}, drop standard error columns from \code{models}.
Default \code{FALSE}.}
}
\value{
A list of class \code{"egfr_traj_tibbles"} with two tibbles:
\describe{
\item{models}{One row per subject with columns:
\itemize{
\item \code{id}: subject identifier
\item \code{info}: nested list with \code{pattern}, \code{nobs}, \code{nmiss}, \code{breakpoint_time}, \code{bp_se}
\item \code{linear}, \code{quadratic}, \code{segmented}: nested lists with model coefficients,
SEs, AIC/BIC (simplified if \code{best_model_only = TRUE})
}
}
\item{fitted}{One row per observation with columns:
\itemize{
\item \code{id}: subject identifier
\item \code{time}: time point
\item \code{egfr}: observed eGFR value
\item \code{fitted_value}: fitted value from the selected model
\item \code{conf_low}, \code{conf_high}: prediction interval bounds
}
}
}
}
\description{
Applies \code{classify_single_trajectory()} to each subject in the dataset and returns
a simplified, tibble-based structure with two components: one row per subject for model
summaries, and one row per observation for fitted values.
}
\details{
\itemize{
\item Subjects with fewer than 5 valid observations are handled as \code{"insufficient_data"}.
\item Segmented models with unreliable breakpoint are downgraded to linear in the single
classification step.
\item Use \code{summary()} or \code{plot()} on individual elements when \code{best_model_only = FALSE}.
}
}
\examples{
library(egfrtraj)

# Classify all subjects
traj_all <- classify_multiple_trajectories(example_egfr_data)

# Inspect structure
names(traj_all)               # "models" "fitted"
class(traj_all)               # "egfr_traj_tibbles"

# Model summary (one row per subject)
traj_all$models

# Fitted values (long format, one row per observation)
head(traj_all$fitted)

# Example: plot one subject from fitted data
single_id <- "11"
single_traj <- traj_all$fitted \%>\% dplyr::filter(id == single_id)
# (use plot.egfr_traj on single trajectory if needed)

}
